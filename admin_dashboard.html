<!DOCTYPE html>
<html>
<head>
    <title>Admin Dashboard</title>
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
    <style>
        body {
            margin: 0;
            padding: 0;
            display: flex;
        }

        .sidebar {
            background: #f8f9fa;
            padding: 20px;
            width: 200px;
        }

        .sidebar a {
            display: block;
            margin-bottom: 10px;
            text-decoration: none;
        }

        .content {
            padding: 20px;
            flex: 1;
        }

        table {
            width: 100%;
        }

        table th, table td {
            padding: 8px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
    </style>
</head>
<body>
    <div class="sidebar">
        <a href="#" onclick="getAllAdmins()">Get All Admins</a>
        <a href="#" onclick="logout()">Logout</a>
        <a href="#" onclick="createStationMaster()">Create Station Master</a>
        <a href="#" onclick="getAllStationMasters()">Get All Station Masters</a>
    </div>

    <div class="content">
        <!-- Content area -->
    </div>

    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
    <script>
        function getAllAdmins() {
            axios.get('https://transitserver.govindsr.me/api/v2/getAllAdmins')
                .then(function (response) {
                    displayAdmins(response.data);
                })
                .catch(function (error) {
                    console.log(error);
                });
        }

        function logout() {
            axios.get('https://transitserver.govindsr.me/api/v2/logoutAdmin')
                .then(function (response) {
                    window.location.href = 'index.html';
                })
                .catch(function (error) {
                    console.log(error);
                });
        }

        function createStationMaster() {
            var username = prompt("Enter the username:");
            var email = prompt("Enter the email:");
            var password = prompt("Enter the password:");

            var data = {
                username: username,
                email: email,
                password: password
            };

            axios.post('https://transitserver.govindsr.me/api/v2/createStationMaster', data)
                .then(function (response) {
                    alert("Station Master created successfully!");
                })
                .catch(function (error) {
                    alert("Failed to create Station Master. Please try again.");
                    console.log(error);
                });
        }

        function getAllStationMasters() {
            // Your code to get all station masters
            console.log("Getting all station masters...");
            axios.get('https://transitserver.govindsr.me/api/v2/getAllStationMasters')
                .then(function (response) {
                    displayStationMasterData(response.data);
                })
                .catch(function (error) {
                    console.log(error);
                });
        }

        function displayStationMasterData(stationMasters) {
            var content = document.querySelector('.content');
            content.innerHTML = "<h3>All Station Masters</h3>";

            if (stationMasters.length === 0) {
                content.innerHTML += "<p>No station masters found.</p>";
                return;
            }

            var table = document.createElement("table");
            var thead = document.createElement("thead");
            var tbody = document.createElement("tbody");

            var headRow = document.createElement("tr");
            headRow.innerHTML = "<th>Email</th><th>Username</th><th></th>";
            thead.appendChild(headRow);

            for (var i = 0; i < stationMasters.length; i++) {
                var stationMaster = stationMasters[i];

                var row = document.createElement("tr");
                row.innerHTML = "<td>" + stationMaster.email + "</td><td>" + stationMaster.username + "</td>";

                var deleteButtonCell = document.createElement("td");
                var deleteButton = document.createElement("button");
                deleteButton.textContent = "Delete";
                deleteButton.addEventListener("click", deleteStationMaster.bind(null, stationMaster.email));
                deleteButtonCell.appendChild(deleteButton);

                row.appendChild(deleteButtonCell);
                tbody.appendChild(row);
            }

            table.appendChild(thead);
            table.appendChild(tbody);
            content.appendChild(table);
        }

        function deleteStationMaster(email) {
            axios.delete(`https://transitserver.govindsr.me/api/v2/deleteStationMaster/${email}`,)
                .then(function (response) {
                    alert("Station Master deleted successfully!");
                    // Refresh the station master list
                    getAllStationMasters();
                })
                .catch(function (error) {
                    alert("Failed to delete station master. Please try again.");
                    console.log(error);
                });
        }

        function displayAdmins(admins) {
            var content = document.querySelector('.content');
            content.innerHTML = "<h3>All Admins</h3>";

            if (admins.length === 0) {
                content.innerHTML += "<p>No admins found.</p>";
                return;
            }

            var table = document.createElement("table");
            var thead = document.createElement("thead");
            var tbody = document.createElement("tbody");

            var headRow = document.createElement("tr");
            headRow.innerHTML = "<th>Email</th><th>Username</th><th></th>";
            thead.appendChild(headRow);

            for (var i = 0; i < admins.length; i++) {
                var admin = admins[i];

                var row = document.createElement("tr");
                row.innerHTML = "<td>" + admin.email + "</td><td>" + admin.username + "</td>";

                var deleteButtonCell = document.createElement("td");
                var deleteButton = document.createElement("button");
                deleteButton.textContent = "Delete";
                deleteButton.addEventListener("click", deleteAdmin.bind(null, admin.email));
                deleteButtonCell.appendChild(deleteButton);

                row.appendChild(deleteButtonCell);
                tbody.appendChild(row);
            }

            table.appendChild(thead);
            table.appendChild(tbody);
            content.appendChild(table);
        }

        function deleteAdmin(email) {
            axios.delete(`https://transitserver.govindsr.me/api/v2/deleteAdmin/${email}`,)
                .then(function (response) {
                    alert("Admin deleted successfully!");
                    // Refresh the admin list
                    getAllAdmins();
                })
                .catch(function (error) {
                    alert("Failed to delete admin. Please try again.");
                    console.log(error);
                });
        }

    </script>
</body>
</html>
