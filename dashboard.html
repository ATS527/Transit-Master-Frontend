<!DOCTYPE html>
<html>
<head>
  <title>Dashboard</title>
  <style>
    body {
      display: flex;
    }
    
    .side-panel {
      width: 200px;
      background-color: #f2f2f2;
      padding: 10px;
    }
    
    .content {
      flex-grow: 1;
      padding: 10px;
    }
    
    .table-container {
      margin-top: 20px;
    }
    
    table {
      border-collapse: collapse;
      width: 100%;
    }
    
    th, td {
      padding: 8px;
      text-align: left;
      border-bottom: 1px solid #ddd;
    }
  </style>
</head>
<body>
  <div class="side-panel">
    <h3>Options</h3>
    <button id="createAdminButton">Create an Admin</button>
    <button id="getAllAdminsButton">Get All Admins</button>
  </div>
  
  <div class="content">
    <h1>Welcome to the Dashboard</h1>
    
    <div id="createAdminContainer" style="display: none;">
      <h2>Create an Admin</h2>
      <form id="createAdminForm">
        <label for="username">Username:</label>
        <input type="text" id="username" name="username" required>
        
        <label for="email">Email:</label>
        <input type="email" id="email" name="email" required>
        
        <label for="password">Password:</label>
        <input type="password" id="password" name="password" required>
        
        <button type="submit">Create</button>
      </form>
      <button id="goBackButton">Go Back</button>
    </div>
    
    <div id="getAllAdminsContainer" style="display: none;">
      <h2>All Admins</h2>
      <div class="table-container">
        <table id="adminsTable">
          <thead>
            <tr>
              <th>Username</th>
              <th>Email</th>
            </tr>
          </thead>
          <tbody></tbody>
        </table>
      </div>
      <button id="goBackButton2">Go Back</button>
    </div>
  </div>
  
  <script>
    // Function to toggle the display of elements
    function toggleElementDisplay(elementId, displayValue) {
      var element = document.getElementById(elementId);
      element.style.display = displayValue;
    }
    
    // Attach event listeners to the buttons
    var createAdminButton = document.getElementById("createAdminButton");
    var getAllAdminsButton = document.getElementById("getAllAdminsButton");
    var goBackButton = document.getElementById("goBackButton");
    var goBackButton2 = document.getElementById("goBackButton2");
    
    createAdminButton.addEventListener("click", function() {
      toggleElementDisplay("createAdminContainer", "block");
      toggleElementDisplay("getAllAdminsContainer", "none");
    });
    
    getAllAdminsButton.addEventListener("click", function() {
      toggleElementDisplay("createAdminContainer", "none");
      toggleElementDisplay("getAllAdminsContainer", "block");
      
      // Make API request to get all admins using fetch
      fetch("https://transitserver.theinfinox.in/api/v2/getAllAdmins")
      .then(response => {
        if (response.ok) {
          return response.json();
        } else {
          throw new Error("Failed to get admins. Please try again.");
        }
      })
      .then(data => {
        var adminsTableBody = document.querySelector("#adminsTable tbody");
        adminsTableBody.innerHTML = ""; // Clear the table body
        
        data.forEach(admin => {
          var row = document.createElement("tr");
          row.innerHTML = `<td>${admin.username}</td><td>${admin.email}</td>`;
          adminsTableBody.appendChild(row);
        });
      })
      .catch(error => {
        alert(error.message);
      });
    });
    
    goBackButton.addEventListener("click", function() {
      toggleElementDisplay("createAdminContainer", "none");
    });
    
    goBackButton2.addEventListener("click", function() {
      toggleElementDisplay("getAllAdminsContainer", "none");
    });
    
    // Form submission for creating an admin
    var createAdminForm = document.getElementById("createAdminForm");
    createAdminForm.addEventListener("submit", function(event) {
      event.preventDefault();
      
      var username = document.getElementById("username").value;
      var email = document.getElementById("email").value;
      var password = document.getElementById("password").value;
      
      // Make API request to create an admin using fetch
      fetch("https://transitserver.theinfinox.in/api/v2/createAdmin", {
        method: "POST",
        headers: {
          "Content-Type": "application/json"
        },
        body: JSON.stringify({ username: username, email: email, password: password })
      })
      .then(response => {
        if (response.ok) {
          alert("Admin created successfully!");
          createAdminForm.reset();
        } else {
          throw new Error("Failed to create admin. Please try again.");
        }
      })
      .catch(error => {
        alert(error.message);
      });
    });
  </script>
</body>
</html>